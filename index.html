<!DOCTYPE html>
<html>
<head>
    <title>Yev&#39;s security notes</title>

        <meta charset="utf-8">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <meta name="description" content="">
    <meta name="keywords" content="">
    <meta name="author" content="">
        <meta property="og:title" content="Yev&#39;s security notes" />
    <meta property="og:description" content="" />
    <meta property="og:type" content="website" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:url" content="https://0xphoenix.github.io/" />
    

    <link href="https://0xphoenix.github.io/index.xml" rel="alternate" type="application/rss+xml" title="Yev&#39;s security notes" />
    <link rel="shortcut icon" href="/favicon.png">

    <link href="https://0xphoenix.github.iowebfonts/ptserif/main.css" rel='stylesheet' type='text/css'>
    <link href="https://0xphoenix.github.iowebfonts/source-code-pro/main.css" rel="stylesheet" type="text/css">

    <link rel="stylesheet" href="https://0xphoenix.github.iocss/style.css">

    <link href="http://gmpg.org/xfn/11" rel="profile">
    
    <meta name="generator" content="Hugo 0.36" />
</head>

<body>
<div id="container">
    <header id="header">
    <div id="header-outer" class="outer">
        <div id="header-inner" class="inner">
            <a id="main-nav-toggle" class="nav-icon" href="javascript:;"></a>
            <a id="logo" class="logo-text" href="https://0xphoenix.github.io">Yev&#39;s security notes</a>
            <nav id="main-nav">
                
                <a class="main-nav-link" href="/challenges/">Challenges</a>
                
                <a class="main-nav-link" href="/reversing/">Reversings</a>
                
                <a class="main-nav-link" href="/tools/">Tools</a>
                
            </nav>
            <nav id="sub-nav">
                <div id="search-form-wrap">
                </div>
            </nav>
        </div>
    </div>
</header>
    <section id="main" class="outer">
        
        <article class="article article-type-post" itemscope itemprop="blogPost">
            <div class="article-inner">
                
                
                <header class="article-header">
                    <h1 itemprop="name"><a class="article-title" href="/tools/portable-traffic-capture/">Portable Network Traffic Capture</a></h1>
                </header>
                
                <div class="article-meta">
                    <a href="/tools/portable-traffic-capture/" class="article-date">
                        <time datetime='2018-04-01T18:52:01.000-04:00' itemprop="datePublished">2018-04-01</time>
                    </a>
                    
                    
                    <div class="post-categories">
                        <div class="article-category">
                            
                            
                            <a class="article-category-link" href="https://0xphoenix.github.io/categories/tools">Tools</a>
                            
                        </div>
                    </div>
                    
                    
                </div>
                <div class="article-entry" itemprop="articleBody">
                    <p>
                        <img src="images/monitoring.jpg"><br>
                    Recently, I found myself in need of SSL traffic analysis coming out of IoT and mobile devices. After some considerations about the setup of monitoring gear I ended up with using Raspberry Pi 3 as a platform for that because most of the devices were with wifi only and I needed something more mobile at hand. There are some guides to set such platform up but I found them lacking certain things that prevented the whole thing from working for me.
                    </p>
                    <p class="article-more-link">
                        <a href="/tools/portable-traffic-capture/">Read More</a>
                    </p>
                </div>

                
                <footer class="article-footer">
                    <ul class="article-tag-list">
                        
                        <li class="article-tag-list-item">
                            <a class="article-tag-list-link" href="https://0xphoenix.github.io/tags/raspi">raspi
                            </a>
                        </li>
                        
                        <li class="article-tag-list-item">
                            <a class="article-tag-list-link" href="https://0xphoenix.github.io/tags/ssl-stripping">ssl stripping
                            </a>
                        </li>
                        
                        <li class="article-tag-list-item">
                            <a class="article-tag-list-link" href="https://0xphoenix.github.io/tags/wifi-monitor">wifi monitor
                            </a>
                        </li>
                        
                        <li class="article-tag-list-item">
                            <a class="article-tag-list-link" href="https://0xphoenix.github.io/tags/iot">IoT
                            </a>
                        </li>
                        
                        <li class="article-tag-list-item">
                            <a class="article-tag-list-link" href="https://0xphoenix.github.io/tags/mobile">mobile
                            </a>
                        </li>
                        
                    </ul>
                </footer>
                
            </div>
        </article>
        
        <article class="article article-type-post" itemscope itemprop="blogPost">
            <div class="article-inner">
                
                
                <header class="article-header">
                    <h1 itemprop="name"><a class="article-title" href="/challenges/flare/flareon_2014_1/">Flare-On 2014 Chellage 1</a></h1>
                </header>
                
                <div class="article-meta">
                    <a href="/challenges/flare/flareon_2014_1/" class="article-date">
                        <time datetime='2014-09-23T18:52:01.000-04:00' itemprop="datePublished">2014-09-23</time>
                    </a>
                    
                    
                    <div class="post-categories">
                        <div class="article-category">
                            
                            
                            <a class="article-category-link" href="https://0xphoenix.github.io/categories/challenges">Challenges</a>
                            
                        </div>
                    </div>
                    
                    
                </div>
                <div class="article-entry" itemprop="articleBody">
                    <p>
                        <img src="images/flareon.jpg"><br>
                    The binary can be downloaded from the original site. Quick check shows that this is a .NET executable with some humor:
Using very handy .NET decompiler, ILSpy, let’s check the source of this funny thing with emphasis on the implementation of Decode event handler:
private void btnDecode_Click(object sender, EventArgs e) { this.pbRoge.Image = Resources.bob_roge; byte[] dat_secret = Resources.dat_secret; string text = &quot;&quot;; for (int i = 0; i &lt; dat_secret.Length; i++) { byte b = dat_secret[i]; text += (char)((b &gt;&gt; 4 | ((int)b &lt;&lt; 4 &amp; 240)) ^ 41); } text += &quot;\0&quot;; string text2 = &quot;&quot;; for (int j = 0; j &lt; text.
                    </p>
                    <p class="article-more-link">
                        <a href="/challenges/flare/flareon_2014_1/">Read More</a>
                    </p>
                </div>

                
                <footer class="article-footer">
                    <ul class="article-tag-list">
                        
                        <li class="article-tag-list-item">
                            <a class="article-tag-list-link" href="https://0xphoenix.github.io/tags/reversing">reversing
                            </a>
                        </li>
                        
                        <li class="article-tag-list-item">
                            <a class="article-tag-list-link" href="https://0xphoenix.github.io/tags/challenge">challenge
                            </a>
                        </li>
                        
                        <li class="article-tag-list-item">
                            <a class="article-tag-list-link" href="https://0xphoenix.github.io/tags/flare-on">Flare-On
                            </a>
                        </li>
                        
                    </ul>
                </footer>
                
            </div>
        </article>
        
        <article class="article article-type-post" itemscope itemprop="blogPost">
            <div class="article-inner">
                
                
                <header class="article-header">
                    <h1 itemprop="name"><a class="article-title" href="/challenges/flare/flareon_2014_2/">Flare-On 2014 Chellage 2</a></h1>
                </header>
                
                <div class="article-meta">
                    <a href="/challenges/flare/flareon_2014_2/" class="article-date">
                        <time datetime='2014-09-23T18:52:01.000-04:00' itemprop="datePublished">2014-09-23</time>
                    </a>
                    
                    
                    <div class="post-categories">
                        <div class="article-category">
                            
                            
                            <a class="article-category-link" href="https://0xphoenix.github.io/categories/challenges">Challenges</a>
                            
                        </div>
                    </div>
                    
                    
                </div>
                <div class="article-entry" itemprop="articleBody">
                    <p>
                        <img src="images/flareon.jpg"><br>
                    In this one, flare-on.com site was attacked. The attacker left “something” behind for us to investigate. We are getting the snapshot of the site for analysis and the email is somewhere inside:
After analysis of the original site against the challenge files, the “secret” is found in the image file (flare-on.png) and that is where the “digging” will take place:
Let’s extract that hidden message for further processing - Stage 0:
                    </p>
                    <p class="article-more-link">
                        <a href="/challenges/flare/flareon_2014_2/">Read More</a>
                    </p>
                </div>

                
                <footer class="article-footer">
                    <ul class="article-tag-list">
                        
                        <li class="article-tag-list-item">
                            <a class="article-tag-list-link" href="https://0xphoenix.github.io/tags/reversing">reversing
                            </a>
                        </li>
                        
                        <li class="article-tag-list-item">
                            <a class="article-tag-list-link" href="https://0xphoenix.github.io/tags/challenge">challenge
                            </a>
                        </li>
                        
                        <li class="article-tag-list-item">
                            <a class="article-tag-list-link" href="https://0xphoenix.github.io/tags/flare-on">Flare-On
                            </a>
                        </li>
                        
                    </ul>
                </footer>
                
            </div>
        </article>
        
        <article class="article article-type-post" itemscope itemprop="blogPost">
            <div class="article-inner">
                
                
                <header class="article-header">
                    <h1 itemprop="name"><a class="article-title" href="/challenges/flare/flareon_2014_3/">Flare-On 2014 Chellage 3</a></h1>
                </header>
                
                <div class="article-meta">
                    <a href="/challenges/flare/flareon_2014_3/" class="article-date">
                        <time datetime='2014-09-23T18:52:01.000-04:00' itemprop="datePublished">2014-09-23</time>
                    </a>
                    
                    
                    <div class="post-categories">
                        <div class="article-category">
                            
                            
                            <a class="article-category-link" href="https://0xphoenix.github.io/categories/challenges">Challenges</a>
                            
                        </div>
                    </div>
                    
                    
                </div>
                <div class="article-entry" itemprop="articleBody">
                    <p>
                        <img src="images/flareon.jpg"><br>
                    This challenge is about analyzing a binary file. Using IDA. we see here a sort of “obfuscation” where the actual code (payload) is moved into the stack by the loader and executed from there:
The payload is actually a multi-stage xor based, self decrypting code which in our case has various funny sentences revealed in every decrypted part:
   Stage Result              I hope, you’ve got the idea here.
                    </p>
                    <p class="article-more-link">
                        <a href="/challenges/flare/flareon_2014_3/">Read More</a>
                    </p>
                </div>

                
                <footer class="article-footer">
                    <ul class="article-tag-list">
                        
                        <li class="article-tag-list-item">
                            <a class="article-tag-list-link" href="https://0xphoenix.github.io/tags/reversing">reversing
                            </a>
                        </li>
                        
                        <li class="article-tag-list-item">
                            <a class="article-tag-list-link" href="https://0xphoenix.github.io/tags/challenge">challenge
                            </a>
                        </li>
                        
                        <li class="article-tag-list-item">
                            <a class="article-tag-list-link" href="https://0xphoenix.github.io/tags/flare-on">Flare-On
                            </a>
                        </li>
                        
                    </ul>
                </footer>
                
            </div>
        </article>
        
        <article class="article article-type-post" itemscope itemprop="blogPost">
            <div class="article-inner">
                
                
                <header class="article-header">
                    <h1 itemprop="name"><a class="article-title" href="/challenges/flare/flareon_2014_4/">Flare-On 2014 Chellage 4</a></h1>
                </header>
                
                <div class="article-meta">
                    <a href="/challenges/flare/flareon_2014_4/" class="article-date">
                        <time datetime='2014-09-23T18:52:01.000-04:00' itemprop="datePublished">2014-09-23</time>
                    </a>
                    
                    
                    <div class="post-categories">
                        <div class="article-category">
                            
                            
                            <a class="article-category-link" href="https://0xphoenix.github.io/categories/challenges">Challenges</a>
                            
                        </div>
                    </div>
                    
                    
                </div>
                <div class="article-entry" itemprop="articleBody">
                    <p>
                        <img src="images/flareon.jpg"><br>
                    In this task, there is a PDF file only. The first thought that crossed my mind was that there is some kind of exploit embedded in it. Let’s analyze the file to see what secrets it got hidden. There are several ways to do it: online resources (wepwet) or local. I’ll use the later as online will do most of work for you and you will miss all the fun and knowledge.
                    </p>
                    <p class="article-more-link">
                        <a href="/challenges/flare/flareon_2014_4/">Read More</a>
                    </p>
                </div>

                
                <footer class="article-footer">
                    <ul class="article-tag-list">
                        
                        <li class="article-tag-list-item">
                            <a class="article-tag-list-link" href="https://0xphoenix.github.io/tags/reversing">reversing
                            </a>
                        </li>
                        
                        <li class="article-tag-list-item">
                            <a class="article-tag-list-link" href="https://0xphoenix.github.io/tags/challenge">challenge
                            </a>
                        </li>
                        
                        <li class="article-tag-list-item">
                            <a class="article-tag-list-link" href="https://0xphoenix.github.io/tags/flare-on">Flare-On
                            </a>
                        </li>
                        
                    </ul>
                </footer>
                
            </div>
        </article>
        

        

<nav id="page-nav">
    
    
    
    <span class="page-number current">1</span>
    
    
    
    <a href="/page/2/">2</a>
    
    
    
    <a href="/page/3/">3</a>
    
    

    
    <a href="/page/2/" rel="next" class="extend next">Next &raquo;</a>
    
</nav>

    </section>
    <footer id="footer">
    <div class="outer">
        <div id="footer-info" class="inner">
            &copy; 2018 Yev&#39;s security notes&nbsp;
            Powered by <a href="https://gohugo.io" target="_blank">Hugo</a> with theme <a href="https://github.com/carsonip/hugo-theme-minos">Minos</a>
        </div>
    </div>
    

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/tomorrow-night.min.css" integrity="sha256-2wL88NKUqvJi/ExflDzkzUumjUM73mcK2gBvBBeLvTk=" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js" integrity="sha256-KbfTjB0WZ8vvXngdpJGY3Yp3xKk+tttbqClO11anCIU=" crossorigin="anonymous"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    
    <script>
        document.getElementById('main-nav-toggle').addEventListener('click', function () {
            var header = document.getElementById('header');
            if (header.classList.contains('mobile-on')) {
                header.classList.remove('mobile-on');
            } else {
                header.classList.add('mobile-on');
            }
        });
    </script>
</footer>
</div>
</body>
</html>